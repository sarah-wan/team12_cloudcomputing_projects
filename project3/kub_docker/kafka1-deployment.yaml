
apiVersion: apps/v1
kind: Deployment        # We are testing the Deployment resource type
metadata:
  name: kafka1-deployment  # A name must be given to the Job type in the metadata section

spec:                     # This is the specification where we can even put the number of replicas
  replicas: 1
  selector:
    matchLabels:
      app: broker1-app
  minReadySeconds: 30

  template:
    metadata:
      labels:
        app: broker1-app
    spec:
      containers:
      - name: kafka
        image: kafka
        imagePullPolicy: Never
        command: ["/bin/sh"]
        args: ["/kafka/bin/kafka-server-start.sh", "/kafka/config/server.properties", "--override", "broker.id=1", "--override", "listeners=PLAINTEXT://:9092", "--override", "auto.create.topics.enable=true", "--override", "listener.security.protocol.map=PLAINTEXT:PLAINTEXT,SSL:SSL,SASL_PLAINTEXT:SASL_PLAINTEXT,SASL_SSL:SASL_SSL", "--override", "advertised.listeners=PLAINTEXT://kafka1-svc:30001", "--override", "zookeeper.connect=zookeeper-svc:2181"]
        ports:
        - containerPort: 9092